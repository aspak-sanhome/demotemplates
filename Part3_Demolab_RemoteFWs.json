{
  "AWSTemplateFormatVersion": "2010-09-09",
   "Description" : "Barracuda NextGen Firewall Demo Lab VPC",

  "Parameters" : {


   "ArchTagName" : {
    	"Type" : "String",
    	"Default" : "DemoLabVPC",
    	"Description" : "Enter the Modifier prepended to resources of this template"
    	}
  },


  "Resources": {

  "IBKVPCStack":{
    "Type" : "AWS::CloudFormation::Stack",
  	       "Properties" : {
  	           "TemplateURL" : "https://s3-eu-west-1.amazonaws.com/campustemplates/VPC-only.json",
  	           "Parameters" : {
  	               "ArchTagName" : "VPCHub",
  	               "VPC" : "10.101.0.0/16",
                    "PublicSubnet1" : "10.101.0.0/24",
                    "PublicSubnet2" : "10.101.10.0/24",
                    "PrivateSubnet1" : "10.101.1.0/24",
                    "PrivateSubnet2" : "10.101.2.0/24"
  	           }
          }
        },

        "IBKFWstack":{
              "DependsOn" : "IBKVPCStack",
              "Type" : "AWS::CloudFormation::Stack",
                     "Properties" : {
                         "TemplateURL" : "https://s3-eu-west-1.amazonaws.com/campustemplates/managed-generic.json",
                         "Parameters" : {
                           "LicenceMode": "PAYG",
                           "InstanceType": "t2.small",
                           "IAMProfile": "NextGenFirewallRole",
                           "CCIPAddress": "34.240.249.28",
                           "CCUser": "root",
                           "CCPassword": "Ziosch17$",
                           "CCCluster": "Innsbruck",
                           "CCRange": "2",
                           "CCBoxname": "Innsbruck",
                           "PrivateIpAddress": "10.101.0.10",
                           "SecondaryPrivateIpAddress" : "10.101.0.15",
                           "VPCId": { "Fn::GetAtt" : [ "IBKVPCStack", "Outputs.VPC" ] },
                           "SubnetId": { "Fn::GetAtt" : [ "IBKVPCStack", "Outputs.PublicSubnet1" ] }
                         }
                    }
                  },
                  "EIP1IBK":{
                                "Type" : "AWS::CloudFormation::Stack",
                                 "DependsOn" : "IBKFWstack",
                                "Properties" : {
                                     "TemplateURL" : "https://s3-eu-west-1.amazonaws.com/campustemplates/associateEIP.json",
                                     "Parameters" : {
                                     "EIPaddressIdPrimary" : "eipalloc-0ccacd36",
                                     "EIPaddressIdSecondary" : "eipalloc-cdcacdf7",
                                     "instanceId" :  { "Fn::GetAtt" : [ "IBKFWstack", "Outputs.instanceId" ] },
                                     "PrimaryPrivateIPAddress" : "10.101.0.10",
                                     "SecondaryPrivateIpAddress" : "10.101.0.15"
                                           }
                                      }
                    }
 },

 "Outputs" : {




  }


 }
